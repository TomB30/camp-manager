# Type System Organization

This document explains how TypeScript types are organized in the camp manager application.

## File Structure

### `openapi.yaml` (Source of Truth)

All entity schemas are defined in the OpenAPI specification at the root of the project. This serves as the single source of truth for all data types in the system.

### `src/types/api.ts` (Auto-generated)

This file is **automatically generated** from `openapi.yaml` using `openapi-typescript`.

**Important:**
- ⚠️ **DO NOT edit this file manually** - your changes will be overwritten
- Generated by running: `npx openapi-typescript openapi.yaml -o src/types/api.ts`
- Contains raw OpenAPI types in the format: `components["schemas"]["TypeName"]`

### `src/types/index.ts` (Type Aliases)

This file provides convenient type aliases for easier imports throughout the codebase.

**Important:**
- ✅ **This file should be manually updated** when you add new schemas to `openapi.yaml`
- Imports from `api.ts` and exports clean type aliases
- Makes it easy to import types without verbose `components["schemas"]["..."]` syntax

## Workflow: Adding a New Type

### Step 1: Add Schema to OpenAPI

Edit `openapi.yaml` and add your new schema under `components/schemas`:

```yaml
components:
  schemas:
    NewEntity:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
```

### Step 2: Regenerate api.ts

Run the code generation tool:

```bash
npx openapi-typescript openapi.yaml -o src/types/api.ts
```

### Step 3: Add Type Alias

Edit `src/types/index.ts` and add the new type alias:

```typescript
export type NewEntity = components["schemas"]["NewEntity"];
```

### Step 4: Use the Type

Import and use the type in your code:

```typescript
import type { NewEntity } from '@/types';

const myEntity: NewEntity = {
  id: '123',
  name: 'Example',
  // ...
};
```

## Import Patterns

### ✅ Recommended

Import from the barrel file `@/types`:

```typescript
import type { Camper, StaffMember, Event, Program } from '@/types';
```

### ❌ Not Recommended

Don't import directly from `api.ts`:

```typescript
// Avoid this - too verbose
import type { components } from '@/types/api';
type Camper = components["schemas"]["Camper"];
```

## Current Entity Types

The following types are currently available:

### Core Entities (API-exposed)
- `Camper` - Individual camp participants
- `StaffMember` - Camp staff members
- `Event` - Scheduled camp activities
- `Location` - Physical locations at camp
- `HousingRoom` - Sleeping quarters
- `Area` - Camp areas for categorization
- `Conflict` - Scheduling conflicts
- `Label` - Tags for categorization

### Organizational Entities
- `CamperGroup` - Virtual groups of campers based on filters
- `CamperGroupFilter` - Filter criteria for camper groups
- `FamilyGroup` - Fundamental organizational units (one per housing room)
- `Program` - Collections of activities, staff, and locations
- `Activity` - Event templates with default settings

### Configuration Entities
- `Certification` - Staff certifications/qualifications
- `CampColor` - Customizable color options
- `CampSession` - Time periods for camper registration

## Benefits of This Approach

✅ **Single source of truth** - All types defined in OpenAPI spec
✅ **Type safety** - Full TypeScript benefits across the codebase
✅ **Auto-generation** - No manual type maintenance in `api.ts`
✅ **Clean imports** - Simple, readable import statements
✅ **API documentation** - OpenAPI spec serves as API docs
✅ **Validation** - Can validate data against the schema
✅ **Tooling** - OpenAPI ecosystem (Swagger UI, code generators, etc.)

## Resolving colorId to Hex Values

Since we're using `colorId` references instead of inline hex colors, use the store's `getColorById` getter to resolve color IDs to hex values:

```typescript
// In a component
methods: {
  getItemColor(item: SomeEntity): string {
    if (item.colorId) {
      const color = this.store.getColorById(item.colorId);
      return color?.hexValue || '#6366F1';
    }
    return '#6366F1';
  }
}
```

## Troubleshooting

### Types are missing after regeneration

1. Check that the schema exists in `openapi.yaml`
2. Regenerate `api.ts`: `npx openapi-typescript openapi.yaml -o src/types/api.ts`
3. Verify the type alias exists in `src/types/index.ts`

### Import errors

Make sure you're importing from `'@/types'` not `'@/types/api'` or `'@/types/entities'`.

### Property doesn't exist on type

Check if the property is defined in the OpenAPI schema. If not, add it to `openapi.yaml` and regenerate.
